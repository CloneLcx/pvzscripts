
<html lang="zh-cn">
<head>
<meta charset="UTF-8">
<title>PvZ Scripts</title>
<link rel="icon" href="/favicon.ico">
<link rel="stylesheet" href="/scripts/normalize.css">
<link rel="stylesheet" href="/scripts/style.css">
<link rel="stylesheet" href="/scripts/styles/github.css">
</head>
<body>
<div id="jjdjr" style="color:gray"></div>

<script>
var s = ["五年前 我们开始破坏墙壁 对人类展开攻击 我是铠之巨人 这家伙是超大型巨人"];
var i = Math.floor(Math.random() * s.length);
document.all("jjdjr").innerHTML=s[i];
</script>

<p>最近更新: 2018-11-25</p>
<h1>项目简介</h1>
<p>蟒蛇大战僵尸(Python vs. Zombies)是一个以 Python 语言写成的用于植物大战僵尸键控(脚本操控)的框架, 起源于 <a href="https://tieba.baidu.com/p/4997515699">这里</a>.</p>
<p>本项目可以免去配置构建半自动化脚本所需基础框架的繁重工作, 用户不需要了解其中的实现细节和复杂逻辑, 只需要使用暴露出来的接口函数, 从而可以将精力集中在轨道主流程处理上, 有效快速地完成脚本编写和视频制作.</p>
<p>Python 的语法相比于按键精灵的 Q 语言来说更加简洁, 另外本项目没有按键精灵的通用性考虑, 只针对特定版本的植物大战僵尸游戏, 直接调用底层 Windows API 来实现相关功能, 执行效率更高.</p>
<p>本项目只能在 Windows 7 SP1 以及更高版本上面使用, 目前支持的 Python 版本 &gt;= 3.5, 只支持植物大战僵尸原版 1.0.0.1051 版本(英文原版和汉化二版).</p>
<p>本项目尚在开发中, 如有问题报告或者功能需求可通过 <a href="https://github.com/lmintlcx/pvzscripts">GitHub</a> 或者 <a href="https://jq.qq.com/?_wv=1027&amp;k=5Q6zrTD">QQ群</a> 联系作者.</p>
<p>本项目已提交至 <a href="https://pypi.org/project/pvz/">pypi</a>, 可打开命令提示符通过 <code>pip install pvz</code> 来安装, <code>pip install --upgrade pvz</code> 来升级.</p>
<h1>植物大战僵尸无尽模式</h1>
<h2>游戏本体及修改器下载</h2>
<p><a href="https://pvz.lmintlcx.com/">https://pvz.lmintlcx.com/</a></p>
<h2>阵型</h2>
<p>以下默认时间单位 cs(厘秒), 空间单位 px(像素), 血量单位 HP.</p>
<p>以下只讨论 PC 原版(1.0.0.1051)在获得金向日葵, 解锁生存无尽模式, 买齐所有紫卡植物/模仿者/坚果修复术, 买齐 10 格卡槽, 完成阵型布置之后, 不使用修改器完成生存无尽后期阵型运转.</p>
<p>持续存在的植物布置构成阵型, 在游戏设定框架内能够有效处理所有僵尸组合并且保持阵型完整的操作称为阵解.</p>
<p>阵型布置可借助修改器完成, 无需手动开局. 阵型运转可借助半自动化脚本, 再辅助以手动操作.</p>
<p>阵型和操作密不可分. 脱离解法谈阵型, 只摆阵图不给解法和视频的, 都是耍流氓. 目前还不存在(可以预见的未来也不会有)(在战斗界面)无需任何操作实现挂机无尽的阵型.</p>
<p>模仿者变身的植物都是白色, 使用白色植物多是出于美观因素.</p>
<p>植物种在草地花盆上没有实质作用. 无论有没有花盆花盆上植物的判定范围都不会变(只是贴图位置变高). 相比于花盆上面的永久植物消失而被破阵的代价来说, 花盆被多啃几口拖点时间这点好处也是几乎没有意义的.</p>
<p>玉米炮的右判定相比前轮的花盆/睡莲要偏左(11px?), 因此可以通过投石车/冰车/小丑僵尸碾压/炸掉的方法来实现玉米炮前轮悬空, 同样无实质作用.</p>
<p>在合适的时机生效冰蘑菇可以消除最后一大波水池的三只缠绕着珊瑚的僵尸上浮, 即冰消珊瑚. 释放咖啡豆的时机约为红字出现后玉米炮闪 6~8 下, 冰消屋顶空降三人组的时机相同.</p>
<p>通过临时铲除攻击植物/大蒜变道/厚血僵尸做盾等方法引导梯子僵尸靠近南瓜并将梯子搭在南瓜上构成梯子南瓜, 即搭梯. 作用是保护梯子南瓜里的植物, 实现南瓜和植物无伤, 减小经济压力.</p>
<p>可无尽的阵型都有就算不存在小推车救场也不会让僵尸进家的能力, 为了避免出现触发小推车这种尴尬情况的出现一般会在布阵的时候就把小推车去掉.</p>
<p>存档所在目录 <code>C:\ProgramData\PopCap Games\PlantsVsZombies\userdata</code>.</p>
<p>推荐新手阵型: <a href="https://www.bilibili.com/video/av10358654">DE双冰六炮</a> <a href="https://www.bilibili.com/video/av14555712">NE快六炮</a> <a href="https://www.bilibili.com/video/av13110045">PE经典八炮</a> <a href="https://www.bilibili.com/video/av10978047">FE经典八炮</a> <a href="https://www.bilibili.com/video/av13154832">RE十炮</a> <a href="https://www.bilibili.com/video/av10337164">ME月夜十炮</a> / <a href="https://www.bilibili.com/video/av10915095">搭梯教程</a></p>
<p>参考资料:</p>
<p><a href="https://tieba.baidu.com/p/882307246">【PVZ】特殊时期的特殊贴吧导航。如果能发完就已是最大的幸运</a></p>
<p><a href="https://tieba.baidu.com/p/5194693832">无尽模式新手入门教程</a></p>
<p><a href="https://tieba.baidu.com/f?kz=698297408">【伪视频&amp;百科】“梯子南瓜”使用手册V1.0</a></p>
<h2>出怪生成机制</h2>
<p>游戏内置函数 0x00425840 生成出怪类型, 结果位于 <code>[[[6a9ec0] +768] +54d4]</code> 开始的连续 33 个 bool 类型的地址.</p>
<p>游戏内置函数 0x004092e0 从出怪类型生成出怪列表, 结果位于 <code>[[[6a9ec0] +768] +6b4]</code> 开始的连续 1000 个 int_32 类型的地址.</p>
<p>无尽后期(大约 80flags 之后)每轮总共 1000 只僵尸, 每波 50 只(不含伴舞小鬼), 每次选卡 20 波, 按列表顺序刷出.</p>
<p>以下简述从出怪种子到出怪类型的算法:</p>
<p>:begin</p>
<p>设定出普僵.</p>
<p>合成 MT19937 随机数算法所需要的种子, 由以下几个内存值相加, 若算出的种子为 0 则重置为 0x1105.</p>
<pre><code class="plaintext">[[[6a9ec0] +82c] +20]              // 用户序号
[[6a9ec0] +7f8]                    // 当前模式
[[[[6a9ec0] +768] +160] +6c] * 65  // 当前轮数乘以 101
[[[6a9ec0] +768] +561c]            // 开局时生成的一个随机数
</code></pre>

<p>产生一个 0~4 的随机数, 等于 0 则出报纸, 否则出路障.</p>
<p>设定剩余出怪类型数为 min{当前轮数 + 1, 9}. (第一次选卡轮数为 0.)</p>
<p>生成 0~32 的随机数(僵尸类型代号), 符合下列任一条件则重新生成, 设定要出最终得到的类型僵尸.</p>
<pre><code class="plaintext">已设定出该类型僵尸.
非泳池/浓雾场景的潜水/海豚.
屋顶/月夜场景的舞王/矿工.
夜晚场景的冰车.
轮数小于 2 时的白眼/冰车.
轮数小于 5 时的红眼.
伴舞/鸭子/雪人/雪橇/小鬼.
豌豆/坚果/辣椒/机枪/窝瓜/高坚果僵尸.
</code></pre>

<p>重复以上过程直到已设定的僵尸类型数等于剩余出怪类型数.</p>
<p>:end</p>
<p>旗帜/僵博即使设定也不会出现在出怪列表, 因此后期实际出现的僵尸类型总数为 9~11.</p>
<p>使用修改器调节出怪时所选择的僵尸种类数为 8~12 种比较合理.</p>
<p>设可出怪类型数是 m, 剩余出怪类型数是 n:</p>
<p>普僵/路障/读报/其他僵尸出现的概率分别为 <code>1</code>, <code>0.8+0.2*n/m</code>, <code>0.2+0.8*n/m</code>, <code>n/m</code>.</p>
<p>僵尸类型总数为 9/10/11 的概率分别为 <code>n*(n-1)/(m*(m-1))</code>, <code>n*(m-n)*2/(m*(m-1))</code>, <code>(m-n)*(m-n-1)/(m*(m-1))</code>.</p>
<p>普僵必出, 路障/报纸必出一种, 伴舞/鸭子/雪人/雪橇/小鬼不出, 豌豆/坚果/辣椒/机枪/窝瓜/高坚果僵尸不出, 白天/黑夜/屋顶/月夜不出潜水/海豚, 黑夜不出冰车, 屋顶/月夜不出舞王/矿工.</p>
<p>六大场地的 m 取值分别为 18/17/20/20/16/16, n 从第九次选卡开始取值为 9. 可得如下表格:</p>
<table>
<thead>
<tr>
<th>场景</th>
<th>普僵</th>
<th>路障</th>
<th>读报</th>
<th>其他</th>
<th>9 种</th>
<th>10 种</th>
<th>11 种</th>
</tr>
</thead>
<tbody>
<tr>
<td>白天</td>
<td>100.00%</td>
<td>90.00%</td>
<td>60.00%</td>
<td>50.00%</td>
<td>23.53%</td>
<td>52.94%</td>
<td>23.53%</td>
</tr>
<tr>
<td>黑夜</td>
<td>100.00%</td>
<td>90.59%</td>
<td>62.35%</td>
<td>52.94%</td>
<td>26.47%</td>
<td>52.94%</td>
<td>20.59%</td>
</tr>
<tr>
<td>泳池</td>
<td>100.00%</td>
<td>89.00%</td>
<td>56.00%</td>
<td>45.00%</td>
<td>18.95%</td>
<td>52.11%</td>
<td>28.95%</td>
</tr>
<tr>
<td>浓雾</td>
<td>100.00%</td>
<td>89.00%</td>
<td>56.00%</td>
<td>45.00%</td>
<td>18.95%</td>
<td>52.11%</td>
<td>28.95%</td>
</tr>
<tr>
<td>屋顶</td>
<td>100.00%</td>
<td>91.25%</td>
<td>65.00%</td>
<td>56.25%</td>
<td>30.00%</td>
<td>52.50%</td>
<td>17.50%</td>
</tr>
<tr>
<td>月夜</td>
<td>100.00%</td>
<td>91.25%</td>
<td>65.00%</td>
<td>56.25%</td>
<td>30.00%</td>
<td>52.50%</td>
<td>17.50%</td>
</tr>
</tbody>
</table>
<p><em>从出怪类型到出怪列表的算法过于复杂目前未有详细资料.</em></p>
<p>参考资料:</p>
<p><a href="https://tieba.baidu.com/p/2306159144">这两天研究了一下PVZ的出怪机制</a></p>
<p><a href="https://tieba.baidu.com/p/5714350581">无尽生存僵尸出现概率统计</a></p>
<h2>出怪刷新机制</h2>
<p>每次选卡 20 波僵尸, 上半场 9 波, 下半场 10 波, 关底 1 大波.</p>
<p>刷怪倒计时 <code>[[[6a9ec0] +768] +559c]</code>, 除第一次选卡外开场均为 600 (第一次选卡为 1800), 600cs 后正常减少至 0 再刷出第一波.</p>
<p>第 9/19 波(旗帜波前一波)刷新后, 倒计时被设置为 4500 并正常减少, 本波刷出至少 400cs 并且倒计时减少至 200 前将本波僵尸(除伴舞)全部消灭则被设置为 200. 倒计时减少至 5 时显示红字, 在 5 继续停留 25cs 在 4 停留 725cs, 由红字倒计时 <code>[[[6a9ec0] +768] +55a4]</code> 代替该值从 750 减少至 0, 即倒计时减少至 5 再过 750cs 之后(减少至 4 再过 725cs 之后)刷出下一波. (视觉红字在刷出前 85cs 消失.)</p>
<p>第 20 波(最后一波)刷新后, 倒计时被设置为 5500, 正常减少至 0 时激活白字, 刷出后将场上僵尸全部消灭则立即激活白字并停止倒计时. 白字出现后 500cs 结束本次选卡并将倒计时重置为 600.</p>
<p>此外每波僵尸刷新时倒计时被设置为 2500~3100 之间的随机数, 正常减少至 0 时刷出下一波. 同时确定的还有刷新触发(激活/临界)血量, 为本波总血量的 0.5~0.65 倍.</p>
<p>在本波刷出至少 400cs 并且倒计时减少至 200 前, 若本波僵尸总血量不大于刷新激活血量, 则刷新倒计时被设置为 200, 即激活刷新 201cs 后刷出下一波. (两波僵尸的刷新间隔不小于 601cs.)</p>
<p>本波僵尸总血量计算方式为: (除魅惑断头秒杀垂死小偷外僵尸的)本体血量 + I类饰品血量 + 0.2 * II类饰品血量.</p>
<p>P6 节奏下, 每波僵尸刷新即消灭的一轮时长为 600+601*17+(601-5+750)*2+0+500=14009 (cs), 第 9/19/20 波拖够时间的一轮时长为 600+601*17+(4500-5+750)*2+5500+500=27307 (cs).</p>
<p><em>以上部分数据与植吧已有资料有出入, 读者自行甄别.</em></p>
<p>同样的自然输出的情况下出怪有无巨人时的刷新速度不同, 因此可以分为慢速关和快速关. 自然出怪下很容易出现第 10 波之后某波突然不出红眼的情况, 亦即变速关.</p>
<p>录制表演视频时会使用修改器调出全难度出怪组合(对阵型有威胁的僵尸), 通常都是慢速(极限全红).</p>
<p>自然出怪下旗帜波红眼密度较大(约为其他波次的 3.5 倍), 再加上部分僵尸出生点后移, 通常采用推迟玉米炮发射时机以及补加运算量的方法来避免刷怪延迟.</p>
<p>参考资料:</p>
<p><a href="https://tieba.baidu.com/p/2843347257">图片之下——PVZ程序内存中的数据地址列表(PC v1.0.0.1051限定)</a></p>
<p><a href="https://tieba.baidu.com/p/2155500986">【我是礼物】【EL最多炮合集】来，射个痛快！</a></p>
<h2>常用精确数据</h2>
<p>六大场地及特性:</p>
<p>白天(Day), 黑夜(Night), 泳池(Pool), 浓雾(Fog), 屋顶(Roof), 月夜(Moon).</p>
<p>对应的六大场地无尽模式(Survival: Endless)简称为: DE, NE, PE, FE, RE, ME.</p>
<p>除泳池无尽外其他场地无尽需要通过混乱进入. 先进入对应场地的 生存困难/隐藏无尽/僵王的复仇 模式再混乱到(修改器混乱/改存档编号) 泳池无尽 模式.</p>
<p>DE/PE/RE 白天有天降阳光, 掉落间隔 = min{已掉落阳光数量 x 10 + 425, 950} + rand(0, 275), 开局掉落较快, 掉落 52 个之后稳定在 950~1225.</p>
<p>NE/FE/ME 夜间蘑菇无须唤醒.</p>
<p>DE/NE 舞王只在 2/3/4 路出现.</p>
<p>NE 无冰车, 关底前五列冒出一块墓碑, 每块墓碑冒出一只普僵/路障. 场上最多 12 块墓碑, 墓碑未满且前场没空位则顶掉植物(玉米炮顶掉前轮不受影响, 即"压碑").</p>
<p>PE/FE 3/4 路有水池, 水路植物需要种植在睡莲上, 有鸭子潜水海豚, 关底水路前四列出现珊瑚三人组(普僵/路障/铁桶).</p>
<p>FE 前场有浓雾, 可用三叶草临时吹走或者灯笼(火树)照亮.</p>
<p>RE/ME 后场倾斜, 植物需要种植在花盆上, 无矿工舞王, 存在上界之风, 关底前五列出现空降三人组(普僵/路障/铁桶).</p>
<p>上界之风: 疑似游戏 bug, 屋顶场景底线玉米炮打不准, 只能炸两行的一般僵尸，以及三行的巨人小鬼冰车气球.</p>
<p>坐标表示:</p>
<p>横行九格称为 <code>行</code> 或者 <code>路</code>. DE/NE/RE/ME 场地共有五路, PE/FE 场地共有六路. 从上到下称为 1/2/3/4/5(/6) 路.</p>
<p>六行场地 1/6 路称为边路, 2/5 路称为岸路, 3/4 路称为水路, 1/2/5/6 路称为陆路.</p>
<p>竖列五/六格称为 <code>列</code>. 从左到右称为 1/2/3/4/5/6/7/8/9 列.</p>
<p>格子坐标用其所在的路和列来表示, 比如 <code>2-3</code> <code>(2, 3)</code> 均为二路三列.</p>
<p>游戏分辨率为 800x600, 左上角坐标 (0, 0), 右下角 (799, 599).</p>
<p>每个格子宽度 80, DE/NE 格子高度 100, PE/FE/RE/ME 格子高度 85.</p>
<p>从 路数列数 <code>r-c</code> 到 像素坐标 <code>x-y</code> 的转换时为了精确路数列数可以用小数. (最终得到的像素坐标必须取整处理.)</p>
<p>参考转换过程:</p>
<pre><code class="python"># PE/FE
x = 80 * c
y = 55 + 85 * r

# RE/ME
x = 80 * c
if c &gt;= 6:
    y = 45 + 85 * r
else:
    y = 45 + 85 * r + 20 * (6 - c)

# 其他
x = 80 * c
y = 40 + 100 * r
</code></pre>

<p>卡片(种子包)相关数据:</p>
<p>玉米炮种下后 625 可用, 发射到分离 205, 发射到命中 373, 冷却时间 3475.</p>
<p>屋顶落点位于前场(8~9 列)时 1~7 列(左轮坐标)玉米炮的飞行时间分别为 359 362 364 367 369 372 373.</p>
<p>咖啡豆种下到开始唤醒 100, 种下到完成唤醒 198.</p>
<p>核蘑菇/冰蘑菇/樱桃/辣椒 种下到生效 100.</p>
<p>冰蘑菇首次冻结 400~600, 多次冻结 300~400, 冻结加减速 2000, 冻结水面和云朵 300. 减速效果 50%(部分僵尸 40%), 附带 20 HP 攻击.</p>
<p>窝瓜瞪眼到起跳 126, 瞪眼到生效 181.</p>
<p>垫材常用 CD 750 的植物(花盆/胆小菇/阳光菇/小喷菇).</p>
<p>土豆准备时间 1500, 破土用时 106.</p>
<p>核蘑菇/冰蘑菇/樱桃/辣椒 CD 5000, 土豆/倭瓜 CD 3000.</p>
<p>灰烬生效期间可被小丑炸掉/巨人敲击引爆/两车碾压引爆.</p>
<p>南瓜/坚果/高坚果 CD 3000, 可使用坚果修复术不铲除直接更新处于破损状态的植物.</p>
<p>模仿者变身 320.</p>
<p>向日葵种下(升级为双子向日葵) 300~1250 后首次生产阳光, 生产间隔 2350~2500.</p>
<p>HP: 坚果/南瓜 4000, 高坚果 8000, 大蒜 400, 地刺王 450, 其余植物 300.</p>
<p>僵尸相关数据:</p>
<p>撑杆入场较晚(贴图左对齐), 刷新后 358 完全进入可伤害域(等效 15 预判炮). 对超前置炮最早 607 开始跳跃, 跳跃用时 180. 跳跃后 70 啃普通植物, 113 啃炮.</p>
<p>舞王滑步 300~311, 最早的刚好不能开始召唤伴舞的时间, 超前置炮存在时约为 318(等效 55 预判炮), 超前置炮不存在时约为 340(等效 33 预判炮). 可在刷新后 175 垫舞王.</p>
<p>潜水最早能够对 9 列植物造成伤害 300(等效 73 预判炮).</p>
<p>海豚最早跳过 8 列啃食 650, 最早跳过 7 列啃食 702.</p>
<p>冰车碾压南瓜/普通植物/玉米炮的时间: 九列 197 317 357, 八列 520 652 698, 七列 892 1052 1108, 六列 1350 1553 1625, 五列 1945 2223 2323.</p>
<p>冰道阻止种植: 九列 740, 八列 1178, 七列 1716, 六列 2443. 冰道持续时间 3000.</p>
<p>小丑开盒区间 440~750(早爆丑, 占 5%) 及 1320~2270(晚爆丑, 占 95%), 开盒到爆炸 40+70. 冻结时开盒倒计时停滞.</p>
<p>矿工出土到站稳 130, 眩晕时间 350, 出土后开始啃食 1 列植物最早时机 1620.</p>
<p>跳跳运动过程中判定范围随之变化, 因此在炮落点上一行容易漏掉, 尤其是在前院场地.</p>
<p>小偷刷新后最早 375 可受伤害/冻结, 最晚至少 670 时仍可受冻结. 靶子触地到小偷可被攻击 325, 等待 300. 判定范围 1x3, 在两个曾哥的攻击范围内冻住可稳定冰杀. 小偷不会主动偷取场上最后一株阳光植物.</p>
<p>梯子最早开始啃食时机: 九列普通 126, 九列炮 179, 八列普通 358, 超前置炮 370, 七列普通 543, 准超前置 553, 六列普通 726, 前置炮 780, 五列普通 957, 后置炮 974. 梯子从开始放到放下 48.</p>
<p>投篮坐标达到 650 进入可投篮模式, 转把手时间 73, 攻击间隔 300. 对底线植物刷新后 550-560 之间投掷启动, 完美预判冰免疫波长 1975.</p>
<p>白眼血量 3000, 红眼血量 6000. 巨人血量低于一半且横坐标大于 400 时会扔小鬼, 进入伤害域最晚时间为刷新后 218(等效 155 预判炮). 开敲到命中 134, 收手用时 74, 开始扔小鬼到分离 105, 收手用时 37.</p>
<p>巨人对南瓜/普通植物/玉米炮开始举锤的时间: 九列 202 441 468, 八列 732 854 887, 七列 1156 1245 1417, 六列 1573 1811 1844.</p>
<p>小鬼拦截时机为 106~126, 减速则为 210 之后. 平地(非屋顶)玉米炮及樱桃拦截的范围是生效点所在行及其下一行(共两路).</p>
<p>珊瑚三人组刷新后 200 出现, 50 之后开啃. 水面冻结期间无法出现(冰消珊瑚).</p>
<p>出生点: 旗帜 800, 撑杆 870~879, 冰车 800~809, 投篮 825~834, 巨人 845~854, 雪橇 880~1030, 其他 780~819(旗帜波整体右移 40).</p>
<p>僵尸啃植物 4HP/4cs, 减速 4HP/8cs.</p>
<p><em>以上数据部分为精确内存数值, 部分为实战测量值, 部分为理论计算值, 可能存在一定误差.</em></p>
<p>参考资料:</p>
<p><a href="https://tieba.baidu.com/p/652063536">【Plants VS Zombies】植物/僵尸作战报告最大百科全书</a></p>
<p><a href="https://tieba.baidu.com/p/5288033944">【阵三篇】【补档】给男孩子的自X指南——冰冰教你撸炮</a></p>
<p><a href="https://tieba.baidu.com/p/732011315">历史遗留问题清算——那个世界的时空。</a></p>
<p><a href="https://tieba.baidu.com/p/669861842">〖上界之风〗屋顶火箭弹落点描述</a></p>
<p><a href="https://tieba.baidu.com/p/5499822084">【新人首贴+元旦礼物】乱敲键盘！</a></p>
<p><a href="https://tieba.baidu.com/p/5263235942">【二合一】数据计算相关</a></p>
<p><a href="https://tieba.baidu.com/p/5865997365">超多炮数据的计算校验</a></p>
<p><a href="https://tieba.baidu.com/p/3745008287">【PVZ六周年礼物】关于僵尸出生点分布的测量</a></p>
<h2>轨道语言简述</h2>
<p>用炮操作: P 玉米炮  B 提前炮  S 同步炮  D 延迟炮  d 尾炸炮  p 铲种炮</p>
<p>用卡操作: I 冰蘑菇  N 核蘑菇  A/A'/a 灰烬植物(樱桃/辣椒/倭瓜)  C 垫材</p>
<p>P 类循环常用时长 34.75~36s. C 类循环常用时长 50~56s.</p>
<p>双冰变奏: 一个循环用两个冰的节奏, 范式 ch6/ch9/ch5/ch8/ch4/ch7/ch5*/ch7*/C2f/C5u.</p>
<p>"|": 隔离符, 区分对应不同波次僵尸的操作.</p>
<p>"-": 刷新符, 区分同一波次中的过渡和刷新操作.</p>
<p>"/": 分场符, 区分上下半场在同一波次的不同步操作.</p>
<p>括号内的数字: 波长, 本波到下波的刷新间隔.</p>
<p>催化僵尸刷新的行为称为加法操作(灰烬植物), 延缓僵尸刷新的行为称为减法操作(冰蘑菇/垫材).</p>
<p>刷新时不用冰/立即触发刷新的一波称为无冰波/加速波, 刷新时用冰减速则称为减速波.</p>
<p>代奏: 使用加速卡片起到代替玉米炮的效果.</p>
<p>变奏: 有规律有目的地使用冰蘑菇改变循环的节奏.</p>
<p>常用节奏. (不包含过渡冰和激活炸之外的附加轨, 波长单位秒.)</p>
<p>P4: P|P|P|P, (9|9|9|9)</p>
<p>P5: P|P|P|P|P, (7|7|7|7|7)</p>
<p>P5u: P|P|P|P|P, (6|9|6|9|6)</p>
<p>P6: P|P|P|P|P|P, (6|6|6|6|6|6)</p>
<p>C2: IN|IAA', (25|25)</p>
<p>C3: N|IN|AA'a, (17|17|17)</p>
<!-- 三大变奏 chx: -->

<p>ch4: I-P|I-P, (18|18)</p>
<p>ch5: I-P|I-P|P, (15|15|6)</p>
<p>ch6: I-P|P|I-P|P, (12|6|12|6)</p>
<!-- 三大变奏的夜晚延伸 chx: -->

<p>ch7: I-P|I-P|N|A|P, (18|18|6|6|6)</p>
<p>ch8: I-P|I-P|P|N|A|P, (15|15|6|6|6|6)</p>
<p>ch9: I-P|P|I-P|P|N|A|P, (12|6|12|6|6|6|6)</p>
<!-- 波动变奏 chxu: -->

<p>ch4u: I-P|I-P, (16|19)</p>
<p>ch5u: I-P|I-P|P, (14|16|6)</p>
<!-- 变奏 Cxu: -->

<p>C4u-36s: I-P|P|P, (18|9|9)</p>
<p>C5u-36s: I-P|P|P|P, (18|6|6|6)</p>
<p>C6u: I-P|I-P|N|P, (18|18|9|9)</p>
<p>C7u: I-P|I-P|N|P|P, (17|17|6|6|6)</p>
<p>C8u: I-P|I-P|P|N|P|P, (13|13|6|6|6|6)</p>
<!-- 三冰变奏 Cxi: -->

<p>C6i-36s: I-P|I-P|I-P, (12|12|12)</p>
<p>C7i: I-P|I-P|I-N|P, (18|18|12|6)</p>
<p>C8i: I-P|I-P|I-P|N|P, (13|13|13|6|6)</p>
<p>C9i(ch6): I-P|P|I-P|P|I-P|P, (12|6|12|6|12|6)</p>
<p>常用复合运算:</p>
<p>IP-: 热过渡, 刷新后冰生效并炸掉矿工冰车, 几乎不会触发刷新</p>
<p>PD: D 不早于刷新前 15 收撑杆, 同时补刀红眼</p>
<p>PC: 垫材防撑杆, C 于 P 操作 81 之后种植并尽快铲除</p>
<p>PDC: P 早于刷新前 93, D 延迟 108 拦截小鬼, C 于 P 操作 81 之后种植并尽快铲除</p>
<p>CP: 九列垫舞王, P 不早于刷新前 15 收撑杆</p>
<p>I-CP: 较长冰波垫九列快速僵尸, 保护 78 列炮</p>
<p>P(S)D: P/PS 不早于刷新前 155 全收巨人, 延迟 106~126 拦截小鬼</p>
<p>Pd: 尾炸小鬼, 原速参考延时 250, 减速参考延时 350</p>
<p>PI (ICE1): 冰减压, 冻住红眼和撑杆</p>
<p>PI (ICE2): 冰同步或者稍早于炮生效, 冻住即将投掷小鬼的巨人于下一波解决</p>
<p>PI (ICE3): 冰延迟 105(减速 210) 生效取消小鬼投掷</p>
<p>PSD: PS 瞬杀白眼并触发红眼投掷, D 拦截小鬼并重复伤害红眼</p>
<p>I-PDD (ID-PD): P 激活炸, D 消灭白眼并调整红眼投掷时机, D 拦截小鬼同时分离下一波冰车矿工</p>
<p>PD (精准之舞): P 刷新前 15 以收撑杆, D 延迟 107 拦截小鬼以及炸未出土的伴舞</p>
<p>I-PD|PD (下半场节奏/连续拦截): P 冰波激活炮, D 延迟 220 落点前移, P 刷新前 135 拦截并触发本波白眼投掷, D 空拦(尾炸)白眼小鬼</p>
<p>PN (ND5): 前院 3 行核蘑菇延迟 106 生效空拦五路小鬼</p>
<p>PCD: C 于 P 生效之前种植, 延缓巨人投掷时间, D 拦截小鬼同时分离下一波快速僵尸</p>
<p>参考资料:</p>
<p><a href="https://tieba.baidu.com/p/2699120249">【Endless】你们要的奇怪名词——双冰变奏体系讲解</a></p>
<p><a href="https://tieba.baidu.com/p/5288403187">轨道读本提要V3.0</a></p>
<h1>Python 语言</h1>
<h2>安装</h2>
<p>本项目依赖于 Python3, <a href="https://www.python.org/downloads/">下载地址</a>.</p>
<p>根据自己的操作系统位数选择合适的版本, 32 位选择"x86", 64 位选择"x86-64""AMD64".</p>
<p>如果不清楚自己的操作系统位数就选择 32 位的 Python 安装包.</p>
<p><img alt="Python 版本选择" src="/scripts/images/版本选择.png" /></p>
<p>勾选"Add Python 3.x to PATH"添加到环境变量.</p>
<p><img alt="Python 添加到环境变量" src="/scripts/images/添加到环境变量.png" /></p>
<p>打开命令提示符运行<code>python --version</code>检查是否安装成功.</p>
<p><img alt="Python 检查安装是否成功" src="/scripts/images/检查安装是否成功.png" /></p>
<p>对于便携版/多版本共存/其他解释器的用户, 使用绝对路径来运行 Python 解释器.</p>
<p><img alt="Python 绝对路径启动" src="/scripts/images/绝对路径启动.png" /></p>
<h2>运行</h2>
<p>假设脚本文件名为 <code>xxx.py</code>.</p>
<p>1.如果启用了文件关联, 直接双击文件即可运行.</p>
<p>2.打开"命令提示符", 切换到脚本所在目录, (也可以直接在脚本所在目录按住"Shift"并右键选择"在此处打开命令窗口") 运行<code>python xxx.py</code>.</p>
<p><img alt="Python 脚本的运行" src="/scripts/images/脚本的运行.png" /></p>
<p>3.用专业的文本编辑器/集成开发环境调试运行.</p>
<p>正常情况下在命令界面按 <code>Ctrl + C</code> 即可结束脚本运行, 如果无法终止则去任务管理器里找到对应的 Python.exe 进程杀掉.</p>
<h2>语法</h2>
<p>推荐几个在线教程网站.</p>
<p><a href="http://www.runoob.com/python3/python3-tutorial.html">Python 菜鸟教程</a></p>
<p><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000">Python 廖雪峰</a></p>
<p><a href="http://www.pythondoc.com/pythontutorial3/">Python 入门指南</a></p>
<p><a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/">Python Cookbook</a></p>
<p>需要了解的内容主要包括:</p>
<ul>
<li>文件编码(utf-8)</li>
<li>注释格式(单行/多行)</li>
<li>代码块的缩进层级与空行</li>
<li>调试输出(print函数)</li>
<li>导入模块(import语句)</li>
<li>变量及其作用域(global语句)</li>
<li>数据类型(数字/字符串/列表/元组)</li>
<li>运算符(算术/比较/赋值/逻辑/成员)</li>
<li>流程控制(if语句/for语句/range函数)</li>
<li>函数的定义与调用(默认/关键字/可变参数)</li>
</ul>
<h2>编辑</h2>
<p>编写代码最好是用专业的文本编辑器.</p>
<p><a href="https://notepad-plus-plus.org/download/">Notepad++</a> 免费小巧</p>
<p><a href="https://www.sublimetext.com/3">Sublime Text 3</a> 轻量快速, 收费软件</p>
<p><a href="https://code.visualstudio.com/Download">Visual Studio Code</a> 功能丰富, 墙裂推荐</p>
<p><a href="https://www.vim.org/download.php">Vim</a> 编辑器之神, 过于专业不推荐</p>
<p><a href="http://www.gnu.org/software/emacs/download.html">Emacs</a> 神之编辑器, 过于专业不推荐</p>
<p><a href="http://www.jetbrains.com/pycharm/download/">PyCharm</a> 成熟好用, Python 专用, 社区版免费</p>
<p><a href="https://visualstudio.microsoft.com/zh-hans/downloads/">Visual Studio 2017</a> 宇宙最强 IDE, 过于庞大不推荐</p>
<p><strong>不要用记事本!!!</strong> x 3</p>
<h1>脚本编写流程</h1>
<p>声明文字编码为 UTF-8, 尤其是在内容包括汉字的时候. (注意这里只是声明, 文本编辑器保存文件的时候也需要采用该编码.)</p>
<pre><code class="python"># coding=utf-8
</code></pre>

<p>导入本项目的基础函数. (三种方式任选其一即可)</p>
<pre><code class="python"># 方式 1
# 调用时需要加上 pvz. 前缀
import pvz
# pvz.Pao(2, 9)

# 方式 2
# 推荐, 本教程示例均用此种方式
from pvz import *
# Pao(2, 9)

# 方式 3
# 只导入需要的内容, 可给函数取别名
from pvz import Countdown
from pvz import Sleep
from pvz import Pao as P
from pvz import Card as C
# P(2, 9)
</code></pre>

<p>按需求把一些用卡用炮操作封装成函数: (这一步不是必须的, 可以在逐波具体操作中直接调用 <code>Card()</code> 和 <code>Pao()</code>.)</p>
<pre><code class="python"># 在某行某列释放樱桃
def A(row, col):
    Card(&quot;樱桃&quot;, row, col)

# 在水路某行某列释放核蘑菇
def N(row, col):
    Card(&quot;睡莲&quot;, row, col)
    Card(&quot;核蘑菇&quot;, row, col)
    Card(&quot;咖啡豆&quot;, row, col)

# 在某行某列释放原版冰
def Ice(row, col):
    Card(&quot;原版冰&quot;, row, col)

# 在某行某列释放复制冰
def ImitaterIce(row, col):
    Card(&quot;复制冰&quot;, row, col)

# 补坚果/南瓜
pass

# 存冰函数在子线程里运行
# 开场后立即运行
# 存冰位 3-1 3-2 3-3 3-4
# 优先存复制冰, 优先存在永久位
# 每 50.1s 存两个冰, 共 10 个
@RunningInThread
def StoreIce():
    ice_spots = [(3, 1), (3, 2), (3, 3), (3, 4)]
    Countdown(599)
    for i in range(5):
        SafeClick()
        ClickSeed(&quot;复制冰&quot;)
        for spot in ice_spots:
            ClickGrid(spot)
        SafeClick()
        ClickSeed(&quot;原版冰&quot;)
        for spot in ice_spots:
            ClickGrid(spot)
        SafeClick()
        if i != (5 - 1):
            Delay(5000 + 10)

# 点冰
def UseIce():
    ice_spots = [(3, 1), (3, 2), (3, 3), (3, 4)]
    SafeClick()
    ClickSeed(&quot;咖啡豆&quot;)
    for spot in reversed(ice_spots):
        ClickGrid(spot)
    SafeClick()

# 种垫材
def DianCai():
    Card(&quot;花盆&quot;, 1, 9)
    Card(&quot;胆小菇&quot;, 2, 9)
    Card(&quot;阳光菇&quot;, 5, 9)
    Card(&quot;小喷菇&quot;, 6, 9)

# 铲垫材
def ChanDianCai():
    Shovel(1, 9)
    Shovel(2, 9)
    Shovel(5, 9)
    Shovel(6, 9)

# 吹 10 次风扇
# 在子线程里运行
@RunningInThread
def NoFog():
    for i in range(10):
        Card(&quot;三叶草&quot;, 1, 1)
        Delay(2700)

# 吃墓碑
def EatGrave():
    SafeClick()
    ClickSeed(&quot;墓碑吞噬者&quot;)
    for r in range(1, 6):  # 1~5 路
        for c in range(5, 10):  # 5~9 列
            ClickGrid(r, c)
    SafeClick()

# 非旗帜波双边 PSD
def PPSSDD():
    Countdown(95)
    Pao((2, 9), (5, 9), (2, 9), (5, 9))
    Delay(108)
    Pao((1, 8.8), (5, 8.8))

# 炮数足够的情况下最后一波收尾
# 点炮后延迟 30cs 炸珊瑚
def wave20():
    Countdown(180, True)
    Pao(4, 7, 30)
    Delay(90)
    Pao((1, 9), (2, 9), (5, 9), (6, 9))
    Delay(108)
    Pao((1, 9), (2, 9), (5, 9), (6, 9))
</code></pre>

<p>等待 3 秒钟(个人习惯, 启动脚本后给开录像预留时间), 选卡并点击"Let's Rock!".</p>
<pre><code class="python">Sleep(300)

SelectCards([&quot;复制冰&quot;, &quot;寒冰菇&quot;, &quot;咖啡豆&quot;, &quot;樱桃&quot;, &quot;坚果&quot;, &quot;倭瓜&quot;, &quot;花盆&quot;, &quot;胆小&quot;, &quot;阳光&quot;, &quot;小喷&quot;])
</code></pre>

<p>启动自动收集/自动存冰等线程.</p>
<pre><code class="python"># 收集钻石和阳光, 间隔 0.15s
StartAutoCollectThread([3, 4, 5, 6], 15)

# 往 6-1 5-1 2-1 1-1 累计存 8 个寒冰菇
StartAutoFillIceThread([(6, 1), (5, 1), (2, 1), (1, 1)], 8)
</code></pre>

<p>编写具体操作.</p>
<p>如果有相当多的波次操作完全相同, 可以用一个循环变量 wave 遍历 1~20, 对应每次选卡共 20 波僵尸的处理, 把相同操作的波次写在同一个分支里.</p>
<pre><code class="python">for wave in range(1, 21):
    if wave == 10:
        # 第 10 波操作
        pass
    elif wave == 20:
        # 第 20 波操作
        pass
    elif wave in (1, 3, 5, 7, 9, 12, 14, 16, 18):
        # 第 1/3/5/7/9/12/14/16/18 波操作
        pass
    else:
        # 剩余波次操作
        pass
</code></pre>

<p>不同波次操作几乎没有相同的情况下, 可以逐波写出来.</p>
<pre><code class="python"># 第 1 波
Prejudge(-95, 1)
pass

# 第 2 波
Prejudge(-95, 2)
pass

# 第 3 波
Prejudge(-95, 3)
pass

# ...

# 第 20 波
Prejudge(-150, 20)
pass
</code></pre>

<pre><code class="python"># 第 1 波
def wave1():
    Countdown(95)
    pass

# 第 2 波
def wave2():
    Countdown(95)
    pass

# 第 3 波, 操作同第 1 波
def wave3():
    wave1()

# ...

# 第 20 波
def wave20():
    Countdown(150, True)
    pass

wave1()
wave2()
wave3()
# ...
wave20()
</code></pre>

<p>对于每一波的处理分为几个部分: 设定预判时间, 执行主要操作, 延时到本波刷新以后(使用 Prejudge 函数时可省略).</p>
<p>常用预判时间 95cs, 早于 149cs 可能炸不全巨人. 第 10 波部分僵尸出生点偏右, 为避免刷怪延迟因此推迟到 55cs, 再晚可能伴舞会出土, 同时可加上樱核补运算量. 第 20 波预判 150cs 可炮炸珊瑚.</p>
<p>第 9/19 波执行完主要操作后可能还需要额外用炮收尾, 所以要在对应波次的地方跳过一定数量的炮数, 使第 10/20 波自动选择的炮位相应地延后. 当然也可以算好时间写好脚本操作自动收尾.</p>
<p>第 20 波视情况炮炸珊瑚/冰消珊瑚/冰杀小偷/炮炸小偷.</p>
<p><code>Countdown</code>和<code>Prejudge</code>的区别: <code>Countdown</code>只阻塞到刷新倒计时数值小于指定数值, 需要用户保证本波操作执行到刷新时间点之后再进行下一波操作. <code>Prejudge</code>参数为相对于刷新时间点的相对时间, 用于预判则为负值, 可自动判断本波的上一波有没有刷出.</p>
<p><code>Sleep</code>和<code>Delay</code>的区别: <code>Sleep</code>借助于操作系统实现延时, 由于 Windows 不是实时操作系统所以实际睡眠时间会有波动. <code>Delay</code>靠读取游戏内部时钟来实现延时, 相比线程睡眠更加精确, 也不用担心游戏中途突然暂停的影响, 缺点是只能在战斗界面使用.</p>
<p><code>Until</code>的参数为与本波刷新时间点的差值, 需要与<code>Prejudge</code>配合使用. 多个<code>Until</code>连用时注意参数大小按时间顺序从小到大.</p>
<p><code>Coffee</code>需要与<code>StartAutoFillIceThread</code>配合使用. 为了减少资源占用该函数存冰并不及时, 需要更精确的控制存冰时间可参考上面的<code>StoreIce</code>和<code>UseIce</code>示例自己实现存冰和点冰函数.</p>
<p>以泳池场地第 3 波预判 95cs 延迟 80cs 的双边 PD 为例, 以下几种写法均可:</p>
<pre><code class="python">Countdown(95, False)
Pao(2, 9)
Pao(5, 9)
Sleep(80)
Pao(2, 9)
Pao(5, 9)
Sleep(15)

Countdown(95, 3 % 10 == 0)
Pao((2, 9), (5, 9))
Delay(80)
Pao((2, 9), (5, 9))
Delay(15)

# 推荐
Prejudge(-95, 3)
Pao((2, 9), (5, 9))
Delay(80)
Pao((2, 9), (5, 9))

Prejudge(-95, 3)
Pao([(2, 9), (5, 9)])
Until(-95 + 80)
Pao([(2, 9), (5, 9)])
</code></pre>

<p><strong>在调试脚本的时候可以把选卡函数注释掉, 手工选卡进入游戏场景然后退回主界面, 找到存档位置设置存档只读. 这样每次调试的时候是直接从选完卡后开始, 省去重新选卡和切换画面的时间. 同样可以在积累了一定工作量(比如上半场前九波完成)之后存个档, 注释掉前面已完成的代码(跳过一定炮数并从第10波开始)再继续之后步骤的编写调试. 等到全部完成后再从选卡阶段录制完整的表演视频.</strong></p>
<p>举例:</p>
<p>手动选卡, 开场即退出, 设置存档只读, 编写调试前 9 波.</p>
<pre><code class="python"># SelectCards(cards)
for wave in range(1, 21):
    pass
</code></pre>

<p>第 10 波刷新前取消存档只读, 退回游戏主菜单, 再次设置存档只读, 跳过一定炮数, 编写调试第 10~19(20) 波.</p>
<pre><code class="python"># SelectCards(cards)
SkipPao(x)
for wave in range(10, 21):
    pass
</code></pre>

<p>待脚本编写完成后用未选完卡的存档重新开始.</p>
<pre><code class="python">SelectCards(cards)
for wave in range(1, 21):
    pass
</code></pre>

<p><strong>炮落点位于自身附近快速点击无法发射的解决方法:</strong></p>
<ul>
<li>
<p>开场不使用脚本自动找炮, 而是用 <code>UpdatePaoList()</code> 手动更新玉米炮列表.</p>
</li>
<li>
<p>发射单门炮且操作前 30cs 内无其他操作时可提前并设置第三个延时发射参数(后续计算累积延时时要加上此延时). <code>Pao(4, 7)</code> -&gt; <code>Pao(4, 7, 30)</code></p>
</li>
<li>
<p>同时发射两门炮时可临时调整两个落点的顺序. <code>Pao((1, 8), (5, 8))</code> -&gt; <code>Pao((5, 8), (1, 8))</code></p>
</li>
</ul>
<h1>示例</h1>
<p><strong>以下部分脚本后期有更新, 可能会出现代码和视频内容不一致的情况.</strong></p>
<h2>PE经典十二炮</h2>
<p><img alt="PE经典十二炮" src="/scripts/images/PE经典十二炮.jpg" /></p>
<p>使用节奏 P6.</p>
<p>声明文件编码. 导入本项目所有函数.</p>
<p>选卡后启动自动收集线程.</p>
<p>变量 wave 值遍历 1~20, 针对波数编写操作.</p>
<p>通常采用 95cs 预判, 往 2-9 5-9 发射两枚玉米炮. 第 9/19 波预留 4 门炮用于手动收尾或者编写脚本自动收尾.</p>
<p>第 10 波推迟到 33cs 预判, 同时补炸樱桃. 炮飞行时间 373cs, 樱桃释放后 100cs 爆炸, 在 (373 - 100)cs 后释放樱桃让樱桃与玉米炮同时生效.</p>
<p>第 20 波预判 150cs 炮炸珊瑚, 落点 4-7. 等待 90cs 后(等效预判 60cs)往前场发射两枚玉米炮, 然后关底手动收尾或者编写脚本自动收尾.</p>
<p>脚本代码 <a href="https://github.com/lmintlcx/pvzscripts/blob/master/scripts/PE12_P6.py">PE12_P6.py</a></p>
<p>演示视频 <a href="https://www.bilibili.com/video/av33569737/">Bilibili</a> / <a href="https://youtu.be/sHGGMe3xxeY">YouTube</a></p>
<h2>PE经典十炮</h2>
<p><img alt="PE经典十炮" src="/scripts/images/PE经典十炮.jpg" /></p>
<p>节奏为核代 P6, 每一波的操作如下:</p>
<blockquote>
<p>1~9 PP PP PP PP PP N PP PP PP
10~19 PPA PP PP PP PP N PP PP PP PP
20 P-PP</p>
</blockquote>
<p>具体描述一下:</p>
<p>第 1/2/3/4/5/7/8/9/11/12/13/14/16/17/18/19 波的操作为预判 95cs 往前场射两门炮, 落点 2-9 5-9.</p>
<p>第 10 波的操作为预判 33cs 往前场射两门炮, 落点 2-9 5-9. 并且在 2-9 加个樱桃以期消除刷怪延迟.</p>
<p>第 20 波的操作为预判 150cs 炮炸珊瑚, 等待 90cs(等效 60cs 预判) 后再炸前场, 落点 2-9 5-9.</p>
<p>第 6/15 波使用核蘑菇代奏. 核蘑菇与玉米炮生效时间相同, 同样在预判过后 373cs. 点下咖啡豆到唤醒 198cs, 唤醒到生效 100cs, 所以要在预判 (373 - 198 - 100)cs 后释放核蘑菇. 第 6 波弹坑 3-9, 第 15 波弹坑 4-9.</p>
<p>第 9/19 波分别预留 4 门炮(极限出怪下)用于手动收尾操作或者编写脚本自动收尾.</p>
<p>另外, 定义了一个"偷菜"函数并且运行在子线程, 第 11 波模拟被小偷偷取后重新种植的情况. (示例用意, 可优化.)</p>
<p>脚本代码 <a href="https://github.com/lmintlcx/pvzscripts/blob/master/scripts/PE10_P6-N.py">PE10_P6-N.py</a></p>
<p>演示视频 <a href="https://www.bilibili.com/video/av34824833/">Bilibili</a> / <a href="https://youtu.be/_vqyPvBYAIE">YouTube</a></p>
<h2>PE二十四炮</h2>
<p><img alt="PE二十四炮" src="/scripts/images/PE二十四炮.jpg" /></p>
<p>节奏依然是万能的 P6, PPDD|ICE2|PPSSDD|PPDD|ICE2|PPSSDD.</p>
<p>精准之舞, 收掉本波撑杆伴舞, 拦截白眼小鬼并不再伤红眼. 撑杆最晚 358 进入伤害域, P 不早于 358 生效. 超前置炮存在时伴舞最早 466 出土, D 早于 466 生效. 同时 PD 间隔不小于 106. 综合考虑, P 操作为 15cs 预判, D 延迟 107cs, D 落点七列偏右.</p>
<p>冰之旋舞, 即 ICE2, 冰同步或稍早于炮生效, 冻住撑杆和准备扔小鬼的巨人等待下一波解决.</p>
<p>六神乱舞, 四炮齐发秒白眼并触发红眼投掷, 两炮拦截并重复伤害红眼以及收掉撑杆.</p>
<p>这里用到了内置存冰点冰函数, 只需指定存冰点, 本项目会自动在可用的情况下及时存冰.</p>
<p>脚本代码 <a href="https://github.com/lmintlcx/pvzscripts/blob/master/scripts/PE24_P6-2I.py">PE24_P6-2I.py</a></p>
<p>演示视频 <a href="https://www.bilibili.com/video/av34827600/">Bilibili</a> / <a href="https://youtu.be/QPwp-mqbXGM">YouTube</a></p>
<h2>PE超前置十六炮</h2>
<p><img alt="PE超前置十六炮" src="/scripts/images/PE超前置十六炮.jpg" /></p>
<p>运行节奏为 ch6, |PPDD|IPP-PP|PPDD|IPP-PP|.</p>
<p>第 1 波 PPDD, 刷新前 95cs 两门预判炮 PP, 至少 80cs 后接两门延迟炮 DD, 收撑杆并补刀红眼.</p>
<p>从点下咖啡豆到寒冰菇生效的时间较长, 第 2 波的预判冰点咖啡豆的操作放在第 1 波进行.</p>
<p>本波波长 600cs, 本波操作在刷新前 95cs 开始, 中途累计延时 80cs, 寒冰菇从点下咖啡豆到生效 298cs (唤醒 198cs + 生效 100cs).</p>
<p>采用 50cs(&gt;=36cs 炸全巨人?) 预判冰, 即下一波在刷新后 50cs 被冻住. 计算可知在 DD 操作之后 (600 + 95 - 80 - 298 + 50)cs 点下咖啡豆即可.</p>
<p>第 2 波僵尸刷新即被冻住, 首先是两门热过渡炮处理掉矿工冰车, 落点可以左移避免炸到刚冒头的其他僵尸.</p>
<p>本波波长是由激活炮的时机决定的, 波长 1200cs, 预判 95cs, 中途累计延时 0, 玉米炮发射后 373cs 生效, 激活到下一波刷出 200cs.</p>
<p>计算得知在 IPP 操作之后 (1200 + 95 - 0 - 373 - 200)s 发射激活炮 PP 即可.</p>
<p>第 9/19 波额外留出一定的炮数手动收尾(也可以算好时间自动操作收尾).</p>
<p>第 20 波炮炸珊瑚, 拖够时间攒齐八炮秒杀红眼, 留下一只普僵拖时间.</p>
<p>脚本代码 <a href="https://github.com/lmintlcx/pvzscripts/blob/master/scripts/PE16_ch6.py">PE16_ch6.py</a></p>
<p>演示视频 <a href="https://www.bilibili.com/video/av34825956/">Bilibili</a> / <a href="https://youtu.be/8e7phSRx7uk">YouTube</a></p>
<h2>PE超前置十二炮</h2>
<p><img alt="PE超前置十二炮" src="/scripts/images/PE超前置十二炮.jpg" /></p>
<p>节奏为 ch6, PPCC|IPP-PP|PPCC|IPP-PP.</p>
<p>这里的存冰位均为永久位, 使用内置存冰函数时无需指定总个数.</p>
<p>节奏大体与上一个例子相同, 缺少炸撑杆补刀红眼的炮, 用垫材起到类似的作用. (通常使用阳光少冷却快的植物作为垫材, 此处恶趣味地滥用昂贵植物.)</p>
<p>常规预判炸无法炸到撑杆, 撑杆对超前置炮最早 607 起跳, 等下一波预判炸落地时撑杆早已跳过超前置炮了, 因此在其跳跃超前置炮之前放置垫材强迫跳跃.</p>
<p>跳跃用时 180, 跳跃后 113 啃炮, 因此垫材需要在发炮之后至少 81 种植以免撑杆啃超前置炮.</p>
<p>小丑最早 440 开盒, 开盒后 110 爆炸, 冻结最小时间 400, 为避免小丑炸九列植物冰波长度缩减为 440 + 110 + 400 + 200 = 1150cs.</p>
<p>相应地预判冰生效时机推迟到刷新后 75cs(&gt;=86cs 炸全巨人?), 第 11 波预判冰不要太晚以免没冻到小偷.</p>
<p>第 9 波收尾稍微拖一下时间, 以免下半场存冰冷却跟不上.</p>
<p>第 10 波推迟发炮并补樱桃以期消除延迟, 因为缩短了整个循环时长, 所以不能推迟太久以免此波所用炮下一轮该用时冷却跟不上.</p>
<p>第 19 波我们假设 1 路留有红眼, 更合理的方式是预留炮手动收尾或者更智能地判断哪一路留有红眼.</p>
<p>第 20 波炮炸珊瑚时为了避免炮落点位于自身附近无法发射, 预判时机提前 30cs, 点炮身 30cs 之后再发射.</p>
<p>脚本代码 <a href="https://github.com/lmintlcx/pvzscripts/blob/master/scripts/PE12_ch6.py">PE12_ch6.py</a></p>
<p>演示视频 <a href="https://www.bilibili.com/video/av34923817/">Bilibili</a> / <a href="https://youtu.be/v6EKVQJnrCw">YouTube</a></p>
<h2>PE新二十二炮</h2>
<p><img alt="PE新二十二炮" src="/scripts/images/PE新二十二炮.jpg" /></p>
<p>ch6, PSD/PDC|IPP-PPDD|PSD/PDC|IPP-PPDD.</p>
<p>上半场为手控常用节奏, 下半场于加速波缩减一炮采用连续拦截定式.</p>
<p>开场时上半场九列临时存冰. (有概率被吃掉)</p>
<p>撑杆跳跃用时 180, 冰至少在垫材种植后 181 生效. 此处(下一波)预判 135 种植垫材, 刷新后 45 撑杆落地, 刷新后 50 冰生效.</p>
<p>下半场刷新后 180 落点 7.2 列热过渡炮收本波矿工冰车和上波撑杆.</p>
<p>其他细节请看代码注释.</p>
<p>脚本代码 <a href="https://github.com/lmintlcx/pvzscripts/blob/master/scripts/PE22_ch6.py">PE22_ch6.py</a></p>
<p>演示视频 <a href="https://www.bilibili.com/video/av34826849/">Bilibili</a> / <a href="https://youtu.be/ycfmXAMYPms">YouTube</a></p>
<h2>FE二十四炮</h2>
<p><img alt="FE二十四炮" src="/scripts/images/FE二十四炮.jpg" /></p>
<p>ch9-56s: PSD/PDC|IPP-PPDD|PSD/PDC|IPP-PPDD|PSD/PDC|AD/PDC|PSD/PDC, (6|13|6|13|6|6|6).</p>
<p>这个节奏相对复杂, 不像之前的例子里有相当多的操作几乎完全相同的波次可以合并, 因此给每一波单独定义一个函数再逐个运行.</p>
<p>原版冰操作写在本波, 复制冰操作写在上波. 垫撑杆操作同样写在下一波.</p>
<p>预判 180 种植垫材, 刷新前 - 100 + 5 种植原版冰, 刷新前 - 100 - 320 + 5 种植复制冰, 使冰稍晚于撑杆跳跃完成后生效.</p>
<p>多个<code>Until</code>连用时注意参数大小按时间顺序从小到大.</p>
<p>适当调节波长等数据保证复用炮冷却能跟上.</p>
<p>脚本代码 <a href="https://github.com/lmintlcx/pvzscripts/blob/master/scripts/FE24_ch9.py">FE24_ch9.py</a></p>
<p>演示视频 <a href="https://www.bilibili.com/video/av34828474/">Bilibili</a> / <a href="https://youtu.be/p-4ZbBtxBrI">YouTube</a></p>
<h2>PE真二炮</h2>
<p><img alt="PE真二炮" src="/scripts/images/PE真二炮.jpg" /></p>
<p>节奏 ch5-35.4s: PPddCC|IPPCC-PPDD|IPPCC-PPDD, (6|14.7|14.7)</p>
<p><em>此解法可能因为小丑炸炮/漏炸撑杆导致破阵.</em></p>
<p>冰波较长预判冰时机相应地提前, 定为 10cs. 对于第一个冰波需要等激活炸触发投掷的小鬼抛出后即下一波刷新 210 - 200 之后再生效, 因此使用 15cs.</p>
<p>加速波垫材操作均放在本波进行, 在本波刷新 600 - 175 后(即下一波刷新 175 前)种植并尽快铲除(注意最晚操作时间要早于下一波预判设定时间), 下一波刷新 5 之后撑杆落地(稍早于冰生效时机).</p>
<p>冰波刷新后 630 用垫, 垫住快速僵尸并减压红眼. 巨人砸垫材 134 收手 74, 激活炮发炮前 (134 + 74) * 2 - 373 = 43cs 铲除垫材避免本波白眼受垫干扰空拦.</p>
<p>上下半场均使用连续拦截, 水路临时高坚果. 附带一个简单的高坚果维护函数供参考.</p>
<p>脚本代码 <a href="https://github.com/lmintlcx/pvzscripts/blob/master/scripts/PE16_ch5.py">PE16_ch5.py</a></p>
<p>演示视频 <a href="https://www.bilibili.com/video/av35369870/">Bilibili</a> / <a href="https://youtu.be/dS2iNkAOoHQ">YouTube</a></p>
<h2>PE垫材二十四炮</h2>
<p><img alt="PE垫材二十四炮" src="/scripts/images/PE垫材二十四炮.jpg" /></p>
<p>P6-C, PDC|PDC|PDC|PDC|PDC|PDC.</p>
<p>调整炮序使得 P 均用前场炮 D 均用后场炮.</p>
<p>垫材选用价格少冷却快的植物, 不早于玉米炮发射后 81 种植, 尽早铲除以免巨人受垫干扰空拦. 垫材函数放在单独的线程运行(新开线程有一定开销不过此处影响不大).</p>
<p>巨人对 78 列炮 887 开始举锤, 加上一次扔小鬼两次砸垫材一次砸炮, D 需要在 887 + (105 + 37) + (134 + 74) * 2 + 134 = 1579 之前落下, 对应的 P 预判时间不晚于 1579 - 108 - 600 - 600 - 373 = -102.</p>
<p>第 10 波至少三个运算量以期消除延迟, 半场 PDC 另一半场分配两门炮, 考虑到玉米炮冷却问题以及处理小偷的需求, 第三个额外运算量不使用樱桃而是用稍晚的同步炮秒杀白眼并炸小偷, 再用樱桃拦截.</p>
<p>脚本代码 <a href="https://github.com/lmintlcx/pvzscripts/blob/master/scripts/PE24_P6-C.py">PE24_P6-C.py</a></p>
<p>演示视频 <a href="https://www.bilibili.com/video/av36724031/">Bilibili</a> / <a href="https://youtu.be/EXdlnIGzKAg">YouTube</a></p>
<h2>NE舞夜惊魂</h2>
<p><img alt="NE舞夜惊魂" src="/scripts/images/NE舞夜惊魂.jpg" /></p>
<p>P6-C, PC|PC|PC|PC|PC|PC.</p>
<p>控制舞王/伴舞行走还是舞蹈的时钟 <code>[[6A9EC0]+838]</code> 不随暂停变化, 通过暂停来跳过行走的过程使舞王/伴舞原地踏步, 即女仆秘籍.</p>
<p>曾哥的命中判定相比开火判定收缩 1 个像素, 利用固定位置的伴舞使曾哥处于永动状态.</p>
<p>1 路地刺王加两曾杀跳跳.</p>
<p>2 路常规预判炸(95cs 预判), 4 路延迟炸撑杆(15cs 预判).</p>
<p>3 路重叠火力攻击.</p>
<p>4 路两个免费垫材轮流垫舞王/红眼. 垫材函数放在单独的线程运行.</p>
<p>刷新后 175 (开炮后 175 + 15) 放垫材, 舞王受垫后 43 开始召唤, 召唤用时 150, 伴舞完全出土前即可被炸.</p>
<p>1/5 路靠 2/4 路冰瓜溅射减速有红眼砸炮可能.</p>
<p>玉米炮前轮的花盆可以被冰车投篮车碾掉/小丑炸掉/墓碑顶掉.</p>
<p>黑夜场地最多冒出 12 块墓碑.</p>
<p>墓碑僵尸大约刷新后 325 冒头, 350 开啃 (目测数据仅供参考), 预判时机 325 - 373 &lt; x &lt; 350 - 373.</p>
<p>此阵运行无阳光消耗.</p>
<p>脚本代码 <a href="https://github.com/lmintlcx/pvzscripts/blob/master/scripts/NE12_P6-C.py">NE12_P6-C.py</a></p>
<p>演示视频 <a href="http://www.bilibili.com/video/av36765461/">Bilibili</a> / <a href="https://youtu.be/lHwCc5WCSq4">YouTube</a></p>
<h1>API 文档</h1>
<p><strong>以下公开接口函数均采用大驼峰法命名, 对应的内部实现均为下划线法命名并以下划线开头.</strong></p>
<h2>查找进程读写内存</h2>
<h3><code>FindPvZ()</code></h3>
<p>查找原版植物大战僵尸游戏进程. 该函数会在导入本项目时自动运行.</p>
<p>@返回值 (bool): 查找成功返回 True, 没找到或是版本不符则返回 False.</p>
<h3><code>ReadMemory(data_type, *address, array=1)</code></h3>
<p>读取内存数据.</p>
<p>@参数 data_type(str): 数据类型, 取自 C/C++ 语言关键字, 包括 ["char", "bool", "unsigned char", "short", "unsigned short", "int", "unsigned int", "long", "unsigned long", "long long", "unsigned long long", "float", "double"]</p>
<p>@参数 address(int): 地址, 可为多级偏移.</p>
<p>@参数 array(int): 数量. 默认一个, 大于一个时需要显式指定关键字.</p>
<p>@返回值 (int/float/bool/tuple): 目标进程不可用时返回 None. 默认情况下返回单个数值, 获取多个数据则返回一个长度为指定数量的元组.</p>
<p>@示例:</p>
<pre><code class="python">ReadMemory(&quot;int&quot;, 0x6a9ec0, 0x768, 0x5560)
9990
</code></pre>

<pre><code class="python">ReadMemory(&quot;bool&quot;, 0x6a9ec0, 0x768, 0x54d4, array=33)
(True, False, True, True, False, True, True, False, True, False, False, False, True, False, False, True, False, False, True, True, False, False, False, False, False, True, False, False, False, False, False, False, True)
</code></pre>

<h3><code>WriteMemory(data_type, values, *address)</code></h3>
<p>写入内存数据.</p>
<p>@参数 data_type(str): 数据类型, 取自 C/C++ 语言关键字, 包括 ["char", "bool", "unsigned char", "short", "unsigned short", "int", "unsigned int", "long", "unsigned long", "long long", "unsigned long long", "float", "double"]</p>
<p>@参数 values(int/float/bool/list/tuple): 需要写入的数据, 多个数据采用列表或者元组形式.</p>
<p>@参数 address(int): 地址, 可为多级偏移.</p>
<p>目标进程不可用时立即返回.</p>
<p>@示例:</p>
<pre><code class="python">WriteMemory(&quot;int&quot;, 9990, 0x6a9ec0, 0x768, 0x5560)
</code></pre>

<pre><code class="python">WriteMemory(&quot;unsigned char&quot;, [0xb0, 0x01, 0xc3], 0x0041d7d0)
</code></pre>

<h2>模拟鼠标点击</h2>
<h3><code>LeftClick(x, y)</code></h3>
<p>鼠标左键单击.</p>
<p>@参数 x(int): 横坐标, 单位像素. 建议范围 [0, 799].</p>
<p>@参数 y(int): 纵坐标, 单位像素. 建议范围 [0, 599].</p>
<p>@示例:</p>
<pre><code class="python">LeftClick(108, 42)  # 左键单击卡槽第一张卡片的位置
</code></pre>

<h3><code>RightClick(x, y)</code></h3>
<p>鼠标右键单击.</p>
<p>@参数 x(int): 横坐标, 单位像素. 建议范围 [0, 799].</p>
<p>@参数 y(int): 纵坐标, 单位像素. 建议范围 [0, 599].</p>
<p>@示例:</p>
<pre><code class="python">RightClick(399, 299)  # 右键单击场地中间位置
</code></pre>

<h3><code>SafeClick()</code></h3>
<p>安全右键. 用于避免操作冲突.</p>
<h3><code>ButtonClick(x, y)</code></h3>
<p>适用于模仿者按钮和菜单按钮的特殊点击.</p>
<p>@参数 x(int): 横坐标, 单位像素. 建议范围 [0, 799].</p>
<p>@参数 y(int): 纵坐标, 单位像素. 建议范围 [0, 599].</p>
<p>@示例:</p>
<pre><code class="python">ButtonClick(490, 550)  # 选卡界面左键单击模仿者卡片
</code></pre>

<h2>延时机制</h2>
<h3><code>Sleep(time_cs):</code></h3>
<p>线程睡眠. 依赖于操作系统线程切换时间片精度, 误差较大.</p>
<p>@参数 time_cs(float): 时间, 单位 cs, 精度 0.1.</p>
<h3><code>Delay(time_cs):</code></h3>
<p>游戏内部时钟延时. 相对于线程睡眠更精确.</p>
<p>只能在战斗界面 <code>[[0x6A9EC0]+0x7FC] == 3</code> 使用. 游戏暂停时计时同样暂停.</p>
<p>@参数 time_cs(int): 时间, 单位 cs, 精度 1.</p>
<h3><code>Countdown(time_cs, hugewave=False)</code></h3>
<p>等待直至本波刷新倒计时数值达到指定值. 调用时需要保证上一波已经刷出.</p>
<p>@参数 time_cs(int): 倒计时数值, 单位 cs, 精度 1. 范围 [200, 0].</p>
<p>@参数 hugewave(bool): 是否为旗帜波, 默认不是. 可用 (波数 % 10 == 0) 判断.</p>
<p>@示例:</p>
<pre><code class="python">Countdown(95)  # 非旗帜波 95cs 预判
</code></pre>

<pre><code class="python">Countdown(55, True)  # 旗帜波 55cs 预判
</code></pre>

<h3><code>Prejudge(time_relative_cs, wave)</code></h3>
<p>等待上一波刷新并且当前时间戳与本波刷新时间点的差值达到指定值.</p>
<p>该函数只能在每波操作开始时执行一次. 用于重置本波刷新时间点数值.</p>
<p>@参数 time_relative_cs(int): 相对时间, 单位 cs, 精度 1. 建议范围 [-200, 400].</p>
<p>@参数 wave(int): 波数. 用于判断上一波是否已经刷出以及本波是否为旗帜波.</p>
<p>@示例:</p>
<pre><code class="python">Prejudge(-95, wave)  # 95cs 预判
</code></pre>

<pre><code class="python">Prejudge(-55, wave)  # 55cs 预判
</code></pre>

<pre><code class="python">Prejudge(-150, 20)  # 第 20 波炮炸珊瑚
</code></pre>

<pre><code class="python">Prejudge(900 - 200 - 373, wave)  # 900cs 波长反应炸
</code></pre>

<h3><code>Until(time_relative_cs)</code></h3>
<p>等待直至当前时间戳与本波刷新时间点的差值达到指定值.</p>
<p>该函数需要配合 Prejudge() 使用.</p>
<p>@参数 time_relative_cs(int): 相对时间, 单位 cs, 精度 1. 建议范围 [-200, 2300].</p>
<p>@示例:</p>
<pre><code class="python">Until(-15)  # 刷新前 15cs
</code></pre>

<pre><code class="python">Until(1150 - 200 - 373)  # 1150cs 波长激活炸
</code></pre>

<h2>选卡/更新炮列表</h2>
<h3><code>SelectCards(seeds_selected=None)</code></h3>
<p>选卡并开始游戏.</p>
<p>选择所有卡片. 点击开始. 更新加农炮列表. 等待开场红字消失.</p>
<p>@参数 seeds_selected(list): 卡片列表, 参数为空默认选择八张紫卡和两张免费卡. 参数个数小于卡槽数则用默认卡片填充.</p>
<p>列表长度需与卡槽格数相同. 单张卡片 seed 可用 int/tuple/str 表示, 不同表示方法可混用.</p>
<p>seed(int): 卡片序号, 0 为豌豆射手, 47 为玉米加农炮, 对于模仿者这个数字再加上 48.</p>
<p>seed(tuple): 卡片位置, 用 (行, 列, 是否模仿者) 表示, 第三项可省略, 默认非模仿者.</p>
<p>seed(str): 卡片常用名称参考附录.</p>
<p>@示例:</p>
<pre><code class="python">SelectCards()
</code></pre>

<pre><code class="python">SelectCards([14, 14 + 48, 17, 2, 3, 30, 33, 13, 9, 8])
</code></pre>

<pre><code class="python">SelectCards([(2, 7), (2, 7, True), (3, 2), (1, 3), (1, 4), (4, 7), (5, 2), (2, 6), (2, 2), (2, 1),])
</code></pre>

<pre><code class="python">SelectCards([&quot;寒冰菇&quot;, &quot;复制冰&quot;, &quot;窝瓜&quot;, &quot;樱桃&quot;, &quot;坚果&quot;, &quot;南瓜&quot;, &quot;花盆&quot;, &quot;胆小&quot;, &quot;阳光&quot;, &quot;小喷&quot;])
</code></pre>

<h3><code>UpdatePaoList(cobs=None)</code></h3>
<p>更新玉米加农炮列表.</p>
<p>选卡时自动调用, 空参数则自动找炮. 若需要自定义炮组请在选卡函数后面使用.</p>
<p>如果出现炮落点位于自身附近快速点击无法发射的现象可通过调整炮序解决.</p>
<p>@参数 cobs(list): 加农炮列表, 包括若干个 (行, 列) 元组, 以后轮坐标为准.</p>
<p>@示例:</p>
<pre><code class="python">UpdatePaoList()
</code></pre>

<pre><code class="python">UpdatePaoList([(3, 1), (4, 1), (3, 3), (4, 3), (1, 5), (2, 5), (3, 5), (4, 5), (5, 5), (6, 5)])
</code></pre>

<h2>场地相关点击函数</h2>
<h3><code>ClickSeed(seed)</code></h3>
<p>点击卡槽中的卡片.</p>
<p>@参数 seed(int/str): 卡槽第几格或者卡片名称.</p>
<p>@示例:</p>
<pre><code class="python">ClickSeed(5)  # 点击第 5 格卡槽
</code></pre>

<pre><code class="python">ClickSeed(&quot;樱桃&quot;)  # 点击卡槽中的樱桃卡片
</code></pre>

<h3><code>ClickShovel()</code></h3>
<p>点击铲子.</p>
<h3><code>ClickGrid(*crood)</code></h3>
<p>点击场上格点.</p>
<p>@参数 crood(float/tuple): 坐标, 两个分别表示 行/列 的数字或者一个 (行, 列) 元组, 数字可为小数.</p>
<p>@示例:</p>
<pre><code class="python">ClickGrid(2, 9)  # ClickGrid((2, 9))  # 点击 2 行 9 列
</code></pre>

<h2>用卡用炮铲子操作</h2>
<h3><code>Card(seed, *crood)</code></h3>
<p>用卡操作.</p>
<p>@参数 seed(int/str): 卡槽第几格或者卡片名称.</p>
<p>@参数 crood(float/tuple): 坐标, 两个分别表示 行/列 的数字或者一个 (行, 列) 元组, 数字可为小数.</p>
<p>@示例:</p>
<pre><code class="python">Card(1, 2, 3)  # 将第 1 张卡片种在 2 行 3 列
</code></pre>

<pre><code class="python">Card(&quot;樱桃&quot;, (5, 9))  # 将卡槽中的樱桃种在 5 行 9 列
</code></pre>

<h3><code>Pao(*params)</code></h3>
<p>用炮操作.</p>
<p>@参数 params(int/tuple/list): 落点.</p>
<p>用两个数字指定落点行数和列数, 为了避免炮落点位于自身附近点击失效可设置第三个延时参数或者调换连续两炮的顺序.</p>
<p>落点参数还可以为一至多个格式为 (行, 列) 的元组, 或者一个包含了这些元组的列表.</p>
<p>@示例:</p>
<pre><code class="python">Pao(2, 9)
</code></pre>

<pre><code class="python">Pao(5, 7, 30)  # 点炮身延迟 30cs 再发射
</code></pre>

<pre><code class="python">Pao((2, 9))
</code></pre>

<pre><code class="python">Pao((5, 4), (1, 4))  # 调整炮序
</code></pre>

<pre><code class="python">Pao([(2, 9), (5, 9), (2, 9), (5, 9)])
</code></pre>

<h3><code>SkipPao(num)</code></h3>
<p>跳过列表中一定数量的玉米炮, 通常用于 wave9/19 手动收尾.</p>
<p>@参数 num(int): 数量.</p>
<h3><code>Shovel(*crood)</code></h3>
<p>用铲子操作.</p>
<p>@参数 crood(float/tuple): 坐标, 两个分别表示 行/列 的数字或者一个 (行, 列) 元组, 数字可为小数.</p>
<p>@示例:</p>
<pre><code class="python">Shovel(2, 3)  # Shovel((2, 3))  # 铲掉 2 行 3 列的植物
</code></pre>

<h2>子线程操作</h2>
<h3><code>RunningInThread</code></h3>
<p>将此装饰器应用到需要在子线程运行的函数上.</p>
<p>@示例:</p>
<pre><code class="python">@RunningInThread
def this_function_runs_on_subthread():
    pass
</code></pre>

<h3><code>StartAutoCollectThread(collect_items=[1, 2, 3, 4, 5, 6, 17], interval_cs=12)</code></h3>
<p>自动收集场上资源. 在单独的子线程运行.</p>
<p>为了避免操作冲突, 鼠标光标放到游戏窗口内部时会暂停收集.</p>
<p>@参数 collect_items(list): 需要收集的资源类型.</p>
<p>1.银币 2.金币 3.钻石 4.阳光 5.小阳光 6.大阳光 17.幼苗</p>
<p>@参数 interval_cs(float): 间隔, 单位 cs, 默认 12.</p>
<p>@示例:</p>
<pre><code class="python">StartAutoCollectThread()
</code></pre>

<pre><code class="python">StartAutoCollectThread([3, 4, 5, 6], 20)  # 只收集钻石和阳光, 间隔 0.2s
</code></pre>

<h3><code>StartAutoFillIceThread(spots=None, total=0xFFFFFFFF)</code></h3>
<p>自动存冰. 在单独的子线程运行.</p>
<p>@参数 spots(list): 存冰点, 包括若干个 (行, 列) 元组. 永久位在前, 临时位在后. 默认为场上现有存冰的位置.</p>
<p>@参数 total(int): 总个数, 默认无限.</p>
<p>@示例:</p>
<pre><code class="python">StartAutoFillIceThread()
</code></pre>

<pre><code class="python">StartAutoFillIceThread([(6, 1), (5, 1), (2, 1), (1, 1)], 10)
</code></pre>

<h3><code>Coffee()</code></h3>
<p>点冰. 使用咖啡豆激活存冰.</p>
<p>优先点临时位. 该函数需要配合自动存冰线程 StartAutoCollectThread() 使用.</p>
<h3><code>StartStopDancerThread()</code></h3>
<p>女仆秘籍. 通过暂停控制舞王/伴舞的跳舞/行走. (此函数实现不佳不建议使用.)</p>
<h1>附录</h1>
<h2>卡片(种子包)名称</h2>
<p>部分函数(<code>SelectCards</code> <code>ClickSeed</code> <code>Card</code>)支持用卡片名称字符串作为参数, 卡片常用名称以及模仿者前缀如下.</p>
<pre><code class="python">seeds_string = [
    [&quot;Peashooter&quot;, &quot;豌豆射手&quot;, &quot;单发&quot;],
    [&quot;Sunflower&quot;, &quot;向日葵&quot;, &quot;小向&quot;],
    [&quot;Cherry Bomb&quot;, &quot;樱桃炸弹&quot;, &quot;樱桃&quot;],
    [&quot;Wall-nut&quot;, &quot;坚果墙&quot;, &quot;坚果&quot;],
    [&quot;Potato Mine&quot;, &quot;土豆雷&quot;, &quot;地雷&quot;],
    [&quot;Snow Pea&quot;, &quot;寒冰射手&quot;, &quot;冰豆&quot;],
    [&quot;Chomper&quot;, &quot;大嘴花&quot;, &quot;食人花&quot;],
    [&quot;Repeater&quot;, &quot;双发射手&quot;, &quot;双发&quot;],
    [&quot;Puff-shroom&quot;, &quot;小喷菇&quot;, &quot;小喷&quot;],
    [&quot;Sun-shroom&quot;, &quot;阳光菇&quot;, &quot;阳光&quot;],
    [&quot;Fume-shroom&quot;, &quot;大喷菇&quot;, &quot;大喷&quot;],
    [&quot;Grave Buster&quot;, &quot;墓碑吞噬者&quot;, &quot;墓碑&quot;],
    [&quot;Hypno-shroom&quot;, &quot;魅惑菇&quot;, &quot;魅惑&quot;],
    [&quot;Scaredy-shroom&quot;, &quot;胆小菇&quot;, &quot;胆小&quot;],
    [&quot;Ice-shroom&quot;, &quot;寒冰菇&quot;, &quot;冰蘑菇&quot;, &quot;冰&quot;],
    [&quot;Doom-shroom&quot;, &quot;毁灭菇&quot;, &quot;核蘑菇&quot;, &quot;核&quot;],
    [&quot;Lily Pad&quot;, &quot;睡莲&quot;, &quot;荷叶&quot;],
    [&quot;Squash&quot;, &quot;窝瓜&quot;, &quot;倭瓜&quot;],
    [&quot;Threepeater&quot;, &quot;三线射手&quot;, &quot;三线&quot;],
    [&quot;Tangle Kelp&quot;, &quot;缠绕海草&quot;, &quot;海草&quot;],
    [&quot;Jalapeno&quot;, &quot;火爆辣椒&quot;, &quot;辣椒&quot;],
    [&quot;Spikeweed&quot;, &quot;地刺&quot;],
    [&quot;Torchwood&quot;, &quot;火炬树桩&quot;, &quot;火树&quot;],
    [&quot;Tall-nut&quot;, &quot;高坚果&quot;, &quot;搞基果&quot;],
    [&quot;Sea-shroom&quot;, &quot;海蘑菇&quot;],
    [&quot;Plantern&quot;, &quot;路灯花&quot;, &quot;灯笼&quot;],
    [&quot;Cactus&quot;, &quot;仙人掌&quot;],
    [&quot;Blover&quot;, &quot;三叶草&quot;, &quot;三叶&quot;],
    [&quot;Split Pea&quot;, &quot;裂荚射手&quot;, &quot;裂荚&quot;],
    [&quot;Starfruit&quot;, &quot;杨桃&quot;, &quot;五角星&quot;, &quot;大帝&quot;],
    [&quot;Pumpkin&quot;, &quot;南瓜头&quot;, &quot;南瓜&quot;],
    [&quot;Magnet-shroom&quot;, &quot;磁力菇&quot;, &quot;磁铁&quot;],
    [&quot;Cabbage-pult&quot;, &quot;卷心菜投手&quot;, &quot;包菜&quot;],
    [&quot;Flower Pot&quot;, &quot;花盆&quot;],
    [&quot;Kernel-pult&quot;, &quot;玉米投手&quot;, &quot;玉米&quot;],
    [&quot;Coffee Bean&quot;, &quot;咖啡豆&quot;, &quot;咖啡&quot;],
    [&quot;Garlic&quot;, &quot;大蒜&quot;],
    [&quot;Umbrella Leaf&quot;, &quot;叶子保护伞&quot;, &quot;莴苣&quot;],
    [&quot;Marigold&quot;, &quot;金盏花&quot;],
    [&quot;Melon-pult&quot;, &quot;西瓜投手&quot;, &quot;西瓜&quot;],
    [&quot;Gatling Pea&quot;, &quot;机枪射手&quot;, &quot;机枪&quot;, &quot;加特林&quot;],
    [&quot;Twin Sunflower&quot;, &quot;双子向日葵&quot;, &quot;双子&quot;],
    [&quot;Gloom-shroom&quot;, &quot;忧郁蘑菇&quot;, &quot;忧郁菇&quot;, &quot;曾哥&quot;],
    [&quot;Cattail&quot;, &quot;香蒲&quot;, &quot;猫尾草&quot;, &quot;小猫&quot;],
    [&quot;Winter Melon&quot;, &quot;冰瓜&quot;, &quot;冰西瓜&quot;],
    [&quot;Gold Magnet&quot;, &quot;吸金磁&quot;, &quot;吸金&quot;],
    [&quot;Spikerock&quot;, &quot;地刺王&quot;, &quot;钢刺&quot;],
    [&quot;Cob Cannon&quot;, &quot;玉米加农炮&quot;, &quot;玉米炮&quot;, &quot;春哥&quot;],
]

seeds_imitater_string = [&quot;Imitater&quot;, &quot;模仿者&quot;, &quot;复制&quot;,]
</code></pre>
<script src="/scripts/highlight.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
